<!DOCTYPE html>
<html>
<head>
  <title>Game of Life</title>
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <script src="gameoflife.js"></script>
</head>
<body>

<h1>Game of Life</h1>

<div id="gameoflife">
  <div id="controls">
    <h2>Rules:</h2>
    <ol>
      <li>Any live cell with fewer than two live neighbours dies, as if caused by under-population.</li>
      <li>Any live cell with two or three live neighbours lives on to the next generation.</li>
      <li>Any live cell with more than three live neighbours dies, as if by overcrowding.</li>
      <li>Any dead cell with exactly three live neighbours becomes a live cell, as if by reproduction.</li>
    </ol>
    
    <select id="rndpct">
       <option value="0.1">0.1</value>
       <option value="0.2">0.2</value>
       <option value="0.3">0.3</value>
       <option value="0.4">0.4</value>
       <option value="0.5">0.5</value>
       <option value="0.6">0.6</value>
       <option value="0.7">0.7</value>
       <option value="0.8">0.8</value>
       <option value="0.9">0.9</value>
       <option value="1.0">1.0</value>
    </select>
    <button onclick="gameoflife_viewjq.gol.setRandomBoard($('#rndpct').val());  gameoflife_viewjq.display();">Randomize Board</button>
    <button onclick="gameoflife_viewjq.step();">Step</button>
    <button id="startstoptimer" onclick="gameoflife_viewjq.toggleTimer();">Start Timer</button>
    Cycles: <span id="cycles"></span>
    Population: <span id="population"></span><br \>
  </div>

  <div id="board" class="board">
     <div class="row" id="r_0">
      <div class="cell" id="c_0_0"></div>
      <div class="cell on" id="c_0_1"> </div>
    </div>
    <div class="row" id="r_0">
      <div class="cell on" id="c_0_0"></div>
      <div class="cell" id="c_0_1"> </div>
    </div>
  </div>
</div>


<script>
console.log("I am here");



var gameoflife_viewjq = {
  gol: gameoflife,
  cellDivs: [],
  run: 0,

  buildboard: function (n, pct) {
    var thisBoard;
    var thisRow;
    var thisCell;

    this.gol.setBoardSize(n);
    this.gol.setRandomBoard(pct);
    
    thisBoard = $('#board');
    //console.log(thisBoard);
    thisBoard.empty();
    for (i=0; i<this.gol.cells.length; i++) {  // rows
      this.cellDivs.push([]);
      thisRow = $("<div>");
      thisRow.addClass("row");
      thisRow.attr("id", "r_"+i);
    //  thisRow = $("<div class=\"row\" id=\"r_"+i+"></div>").appendTo("#board");
      $("#board").append(thisRow); //  $("<div class=\"row\" id=\"r_"+i+"></div>").appendTo("#board");
      //console.log(thisRow);
      for (j=0; j<this.gol.cells[i].length; j++) {
        thisCell = $("<div>");
        this.cellDivs[i][j] = thisCell;
        thisCell.addClass("cell");
        if (this.gol.cells[i][j] === 1) {
          thisCell.addClass("on");
        }
        thisCell.attr("id", "c_"+i+"_"+j);

        //console.log(i+","+j+": "+board[i][j]);
        //console.log(thisCell);
        thisRow.append(thisCell);
        this.cellDivs[i].push(thisCell);
    //    thisCell = $("<div class=\"cell\" id=\"c_"+i+"_"+j+"\"></div>").appendTo(thisRow);
      }
    }
  },
  
// Make this function not create the new divs - just set the class to cell or cell, on for each div
  display:  function () {
           
    var thisBoard;
    var thisRow;
    var thisCell;


    thisBoard = $('#board');
    //console.log(thisBoard);
    //thisBoard.empty();
    for (i=0; i<this.gol.cells.length; i++) {  // rows
      for (j=0; j<this.gol.cells[i].length; j++) {
        thisCell =(typeof this.cellDivs[i][j] != 'undefined') ? this.cellDivs[i][j] : $("<div>");
        thisCell.addClass("cell");
        thisCell.removeClass("on");
        if (this.gol.cells[i][j] === 1) {
          thisCell.addClass("on");
        }
        thisCell.attr("id", "c_"+i+"_"+j);
        //console.log(i+","+j+": "+board[i][j]);
        //console.log(thisCell);
        //thisRow.append(thisCell);
    //    thisCell = $("<div class=\"cell\" id=\"c_"+i+"_"+j+"\"></div>").appendTo(thisRow);
      }
    }
  },

  step: function() {
    this.gol.step(); 
    this.display();
    $('#cycles').html(gameoflife_viewjq.gol.numSteps);
    $('#population').html(gameoflife_viewjq.gol.population);
  },

  toggleTimer: function () {
    
    if (this.run === 0) {
      this.run = 1;
      $('#startstoptimer').html("Stop Timer");
    } else {
      this.run = 0;
      $('#startstoptimer').html("Start Timer");
    }
  }
}



gameoflife_viewjq.buildboard(50,0.2);
//gameoflife_viewjq.gol.setRandomBoard(0.2);
//console.log(gameoflife_viewjq.gol.cells);
//console.log(gameoflife_viewjq.cellDivs);

gameoflife_viewjq.display();

var tid = setInterval(myCode, 1000);

function myCode() {
  if (gameoflife_viewjq.run === 1) {
    gameoflife_viewjq.step();
    
  }
}


</script>

<style>
  .board {
    display: table;
  }

  .row {
    display: table-row;
  }

  .cell {
    display: table-cell;
    background-color: #111111;
    width: 10px;
    height: 10px;
    border: 0px;
    margin: 5px;
    -webkit-transition-property: background-color;
    -webkit-transition-duration: 0.5s;
    -webkit-transition-timing-function: ease-in;
    transition-property: background-color;
    transition-duration: 0.5s;
    transition-timing-function: ease-in;
  }
  .on {
    background-color: #999999;
  }
</style>



</body>
</html>
